name: Cleanup Old Images

on:
  schedule:
    # 毎日 日本時間 朝9:00 (UTC 0:00) に実行
    - cron: '0 0 * * *'
  # 手動で実行ボタンを押せるようにする設定
  workflow_dispatch:

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - name: Call Cleanup API
        run: |
          # --fail を外して、-v (詳細表示) を追加し、エラー内容をログに出す
          curl -v "${{ secrets.APP_URL }}/api/cleanup-images?key=${{ secrets.CRON_SECRET_KEY }}"